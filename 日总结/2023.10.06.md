# 算法

1. ### 设置虚拟头结点：

   * 为什么设置：因为在删除等操作时，要利用前一个节点来删除当前节点，而头结点没有前节点，所以设置一个虚拟头结点来使所有节点的操作一致。

2. 删除链表元素

   1. 因为是删除操作，要利用前一个节点，方便操作，设置虚拟头结点。
   2. **while循环的条件要根据题意改动，当要在循环中操作节点的next时，要保证节点不为空。**

3. 设计链表：

   1. 一个链表要有，节点的定义，虚拟头结点，链表的大小。
   2. 初始化时，初始化虚拟头结点实例和链表大小为0。
   3. 在index处添加节点，就是将新建节点插入到index处，后边的自动后移。注意可以在末尾和链表头部插入。
   4. 删除时要判断删除的节点是否为末尾节点，其操作和其他操作不一样。

4. 反转链表

   1. 反转链表就是将当前节点的next指向其前一个节点，依次反转，直到整个链表反转。因此我们可以定义cur指针在当前节点，定义pre指针指向前一个节点（头结点为null）。由于改变当前节点指向会造成后续节点丢失，
   2. 定义变量保存下一个节点地址，当前节点反转完成后，pre先移动到当前节点，cur移动到变量保存的节点进行循环。

5. 两两交换链表中的节点。

   1. 由于要操作头结点，为了统一代码，设置虚拟头结点。
   2. **一次交换中要使用三个指针，**当前节点cur和cur的下一个节点，这两个节点是进行交换的两个节点。还有cur的前一个节点pre，pre是为了在cur和next交换后重新进行链表连接的。**此外还需要定义一个变量来保存next的下一个节点**，这是为了在交换后使断开的链表重新相连。
   3. 循环条件是，当前节点和下一个节点不为空。在循环中的步骤：保存地址，交换节点，指针后移。

6. 删除链表的倒数第n个节点

   1. **使用双指针法**，先让快指针跑n+1下，然后让快慢指针一起跑，直到快指针为空，此时慢指针刚好停在要删除节点的前一个节点，此时刚好删除。
   2. 由于要操作头结点，所以要定义虚拟头结点。

# 牛客社区

### 私信列表

1. 私信列表显示会话，只要和当前用户有过消息就显示一个会话，会话里显示当前用户和另一个用户的所有消息。
2. 持久层：
   1. 查询所有会话，每个会话只显示最新的消息，
   2. 分页显示
3. 业务层：
4. 表现层：
   1. 每个会话要展示消息，及和当前用户进行会话的用户的信息。
   2. 未读消息要有角标提示。

### 会话详情

1. 持久层：
   1. 根据conversationId进行查询，将两用户会话消息全部查出来。
   2. 根据id修改消息状态，已读，删除。
2. 表现层：
   1. 每个消息一套map，
   2. map里存，消息，发消息人的信息
   3. **将未读转化为已读**

### 删除消息

1. 前端使用异步发送请求，修改html和js文件，
2. 前端和服务器的请求方式要保持一致。
3. 服务器修改消息状态

### 发送私信

1. 插入消息
2. 消息刚写入数据库时状态为0
3. 查看未读消息时是根据消息状态和消息的toId来判断的，如果当前用户是收件人并且该消息为未读状态，那么此消息对于该用户是未读消息。

















